import{_ as p,C as d,c as k,o as a,a0 as t,b as n,w as i,a as l,G as h,a1 as r}from"./chunks/framework.CWt1dO41.js";const b=JSON.parse('{"title":"SSO & Authentication","description":"","frontmatter":{},"headers":[],"relativePath":"integrationen/sso.md","filePath":"integrationen/sso.md"}'),o={name:"integrationen/sso.md"};function g(c,s,u,E,y,m){const e=d("Mermaid");return a(),k("div",null,[s[2]||(s[2]=t('<h1 id="sso-authentication" tabindex="-1">SSO &amp; Authentication <a class="header-anchor" href="#sso-authentication" aria-label="Permalink to &quot;SSO &amp; Authentication&quot;">​</a></h1><h2 id="aktueller-stand" tabindex="-1">Aktueller Stand <a class="header-anchor" href="#aktueller-stand" aria-label="Permalink to &quot;Aktueller Stand&quot;">​</a></h2><p>Die VfL Bochum Website verwendet <strong>keine zentrale SSO-Lösung</strong> für Endbenutzer. Es gibt separate Logins für:</p><table tabindex="0"><thead><tr><th>System</th><th>Authentifizierung</th></tr></thead><tbody><tr><td>Website</td><td>Keine User-Registration sichtbar</td></tr><tr><td>Shop</td><td>Eigenes Account-System</td></tr><tr><td>Ticketing</td><td>Eigenes Account-System</td></tr><tr><td>Mitgliederbereich</td><td>Unklar (evtl. separat)</td></tr></tbody></table><h2 id="empfehlung-fur-drupal" tabindex="-1">Empfehlung für Drupal <a class="header-anchor" href="#empfehlung-fur-drupal" aria-label="Permalink to &quot;Empfehlung für Drupal&quot;">​</a></h2><h3 id="option-1-drupal-als-identity-provider" tabindex="-1">Option 1: Drupal als Identity Provider <a class="header-anchor" href="#option-1-drupal-als-identity-provider" aria-label="Permalink to &quot;Option 1: Drupal als Identity Provider&quot;">​</a></h3><p>Drupal verwaltet Benutzerkonten zentral:</p>',7)),(a(),n(r,null,{default:i(()=>[h(e,{id:"mermaid-64",class:"mermaid my-class",graph:"graph%20LR%0A%20%20%20%20User%5BBenutzer%5D%20--%3E%20Drupal%5BDrupal%5D%0A%20%20%20%20Drupal%20--%3E%7COAuth2%7C%20Shop%0A%20%20%20%20Drupal%20--%3E%7COAuth2%7C%20Tickets%0A%20%20%20%20Drupal%20--%3E%7COAuth2%7C%20Mitglieder%0A"})]),fallback:i(()=>[...s[0]||(s[0]=[l(" Loading... ",-1)])]),_:1})),s[3]||(s[3]=t('<p><strong>Module:</strong></p><ul><li>Simple OAuth (OAuth 2.0 Server)</li><li>Consumers (API Client Management)</li></ul><p><strong>Vorteile:</strong></p><ul><li>Zentrale Benutzerverwaltung</li><li>Single Sign-On möglich</li><li>Volle Kontrolle</li></ul><p><strong>Nachteile:</strong></p><ul><li>Externe Systeme müssen OAuth unterstützen</li><li>Implementierungsaufwand</li></ul><h3 id="option-2-external-identity-provider" tabindex="-1">Option 2: External Identity Provider <a class="header-anchor" href="#option-2-external-identity-provider" aria-label="Permalink to &quot;Option 2: External Identity Provider&quot;">​</a></h3><p>Nutzung eines externen Providers (Keycloak, Auth0):</p>',8)),(a(),n(r,null,{default:i(()=>[h(e,{id:"mermaid-121",class:"mermaid my-class",graph:"graph%20LR%0A%20%20%20%20User%5BBenutzer%5D%20--%3E%20IdP%5BIdentity%20Provider%5D%0A%20%20%20%20IdP%20--%3E%7COIDC%7C%20Drupal%0A%20%20%20%20IdP%20--%3E%7COIDC%7C%20Shop%0A%20%20%20%20IdP%20--%3E%7COIDC%7C%20Tickets%0A"})]),fallback:i(()=>[...s[1]||(s[1]=[l(" Loading... ",-1)])]),_:1})),s[4]||(s[4]=t(`<p><strong>Module:</strong></p><ul><li>OpenID Connect / OAuth client</li></ul><p><strong>Vorteile:</strong></p><ul><li>Professionelle SSO-Lösung</li><li>Unterstützt alle Systeme</li><li>MFA möglich</li></ul><p><strong>Nachteile:</strong></p><ul><li>Zusätzlicher Service</li><li>Lizenzkosten (je nach Provider)</li></ul><h3 id="option-3-separate-accounts-status-quo" tabindex="-1">Option 3: Separate Accounts (Status Quo) <a class="header-anchor" href="#option-3-separate-accounts-status-quo" aria-label="Permalink to &quot;Option 3: Separate Accounts (Status Quo)&quot;">​</a></h3><p>Jedes System behält eigene Benutzerverwaltung:</p><p><strong>Vorteile:</strong></p><ul><li>Keine Migration nötig</li><li>Unabhängigkeit der Systeme</li></ul><p><strong>Nachteile:</strong></p><ul><li>Schlechte User Experience</li><li>Mehrfach-Registrierung</li><li>Keine Datenkonsistenz</li></ul><h2 id="drupal-user-management" tabindex="-1">Drupal User-Management <a class="header-anchor" href="#drupal-user-management" aria-label="Permalink to &quot;Drupal User-Management&quot;">​</a></h2><h3 id="rollen-konzept" tabindex="-1">Rollen-Konzept <a class="header-anchor" href="#rollen-konzept" aria-label="Permalink to &quot;Rollen-Konzept&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Rolle</th><th>Rechte</th></tr></thead><tbody><tr><td>Anonymous</td><td>Öffentliche Inhalte lesen</td></tr><tr><td>Authenticated</td><td>Kommentare, Downloads</td></tr><tr><td>Member</td><td>Mitglieder-Bereich</td></tr><tr><td>Editor</td><td>Content erstellen/bearbeiten</td></tr><tr><td>Admin</td><td>Vollzugriff</td></tr></tbody></table><h3 id="registrierung-falls-gewunscht" tabindex="-1">Registrierung (falls gewünscht) <a class="header-anchor" href="#registrierung-falls-gewunscht" aria-label="Permalink to &quot;Registrierung (falls gewünscht)&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># user.settings.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">visitors_admin_approval</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">verify_mail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">password_strength</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><h3 id="social-login-optional" tabindex="-1">Social Login (optional) <a class="header-anchor" href="#social-login-optional" aria-label="Permalink to &quot;Social Login (optional)&quot;">​</a></h3><p><strong>Module:</strong> Social Auth</p><p>Unterstützte Provider:</p><ul><li>Facebook</li><li>Google</li><li>Apple</li><li>Twitter/X</li></ul><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Installation</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">composer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> require</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> drupal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">social_auth_facebook</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">composer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> require</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> drupal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">social_auth_google</span></span></code></pre></div><h2 id="mitgliederbereich" tabindex="-1">Mitgliederbereich <a class="header-anchor" href="#mitgliederbereich" aria-label="Permalink to &quot;Mitgliederbereich&quot;">​</a></h2><p>Falls ein Mitgliederbereich gewünscht ist:</p><h3 id="funktionalitaten" tabindex="-1">Funktionalitäten <a class="header-anchor" href="#funktionalitaten" aria-label="Permalink to &quot;Funktionalitäten&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>Modul</th></tr></thead><tbody><tr><td>Login/Registration</td><td>Core User</td></tr><tr><td>Profile</td><td>User Profile</td></tr><tr><td>Premium Content</td><td>Content Access / Group</td></tr><tr><td>Downloads</td><td>File Permissions</td></tr><tr><td>Membership Management</td><td>Commerce Membership</td></tr></tbody></table><h3 id="content-access" tabindex="-1">Content Access <a class="header-anchor" href="#content-access" aria-label="Permalink to &quot;Content Access&quot;">​</a></h3><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Zugriff auf Premium-Inhalte einschränken</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vfl_member_node_access</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NodeInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $node, $op, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AccountInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $account) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;premium_content&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($account</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasRole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;member&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AccessResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">allowed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AccessResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forbidden</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AccessResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">neutral</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="security-best-practices" tabindex="-1">Security Best Practices <a class="header-anchor" href="#security-best-practices" aria-label="Permalink to &quot;Security Best Practices&quot;">​</a></h2><h3 id="password-policy" tabindex="-1">Password Policy <a class="header-anchor" href="#password-policy" aria-label="Permalink to &quot;Password Policy&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># password_policy.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">min_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">require_uppercase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">require_lowercase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">require_number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">require_special</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">max_age</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Never expire for regular users</span></span></code></pre></div><h3 id="two-factor-authentication-optional" tabindex="-1">Two-Factor Authentication (optional) <a class="header-anchor" href="#two-factor-authentication-optional" aria-label="Permalink to &quot;Two-Factor Authentication (optional)&quot;">​</a></h3><p><strong>Module:</strong> TFA</p><p>Unterstützte Methoden:</p><ul><li>TOTP (Google Authenticator, etc.)</li><li>Recovery Codes</li><li>Trusted Browsers</li></ul><h3 id="session-management" tabindex="-1">Session Management <a class="header-anchor" href="#session-management" aria-label="Permalink to &quot;Session Management&quot;">​</a></h3><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// settings.php</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ini_set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;session.cookie_secure&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ini_set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;session.cookie_httponly&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TRUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ini_set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;session.cookie_samesite&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Strict&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Session Timeout</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$config[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system.session&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cookie_lifetime&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$config[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;system.session&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;gc_maxlifetime&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="aufwand" tabindex="-1">Aufwand <a class="header-anchor" href="#aufwand" aria-label="Permalink to &quot;Aufwand&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Feature</th><th>Aufwand</th></tr></thead><tbody><tr><td>Basic User Management</td><td>8h</td></tr><tr><td>Mitgliederbereich (basic)</td><td>24h</td></tr><tr><td>SSO mit externem Provider</td><td>40h</td></tr><tr><td>Social Login</td><td>8h</td></tr><tr><td><strong>Gesamt (empfohlen)</strong></td><td><strong>8-40h</strong></td></tr></tbody></table><p><strong>Empfehlung:</strong> Zunächst ohne User-Registration starten, später bei Bedarf erweitern.</p>`,40))])}const C=p(o,[["render",g]]);export{b as __pageData,C as default};
